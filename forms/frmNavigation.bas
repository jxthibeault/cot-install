Version =20
VersionRequired =20
Begin Form
    RecordSelectors = NotDefault
    MinButton = NotDefault
    ControlBox = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    CloseButton = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    BorderStyle =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =10080
    DatasheetFontHeight =11
    ItemSuffix =63
    Left =6435
    Top =1290
    Right =16770
    Bottom =9945
    TimerInterval =10000
    RecSrcDt = Begin
        0xd5e2a17c9eebe540
    End
    Caption ="InstallTrack"
    OnClose ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    OnLoad ="[Event Procedure]"
    AllowDatasheetView =0
    FilterOnLoad =0
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    FitToScreen =1
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =60.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            BorderLineStyle =0
            SizeMode =3
            PictureAlignment =2
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CommandButton
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =1
            Gradient =12
            BackThemeColorIndex =4
            BackTint =60.0
            BorderLineStyle =0
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
        End
        Begin Subform
            BorderLineStyle =0
            BorderThemeColorIndex =1
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            BorderShade =65.0
            ShowPageHeaderAndPageFooter =1
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CustomControl
            OldBorderStyle =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin EmptyCell
            Height =240
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin NavigationControl
            BorderWidth =1
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin NavigationButton
            ForeColor =-2
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            HoverColor =-2
            HoverThemeColorIndex =2
            HoverTint =20.0
            PressedColor =-2
            PressedThemeColorIndex =2
            PressedTint =60.0
            HoverForeColor =-2
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeColor =-2
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
            BackThemeColorIndex =1
            OldBorderStyle =0
            BorderLineStyle =0
            BorderThemeColorIndex =3
            BorderShade =90.0
            ThemeFontIndex =1
            FontName ="Calibri"
            FontWeight =400
            FontSize =11
            ForeThemeColorIndex =0
            ForeTint =75.0
        End
        Begin FormHeader
            Visible = NotDefault
            Height =0
            BackColor =1315470
            Name ="secFormHeader"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
        End
        Begin Section
            CanGrow = NotDefault
            Height =8700
            BackColor =-2147483636
            Name ="secFormDetail"
            AlternateBackColor =0
            Begin
                Begin Rectangle
                    SpecialEffect =0
                    BackStyle =1
                    OverlapFlags =93
                    Width =10080
                    BackColor =-2147483618
                    BorderColor =10921638
                    Name ="shpMenu"
                    GridlineColor =10921638
                    HorizontalAnchor =2
                    LayoutCachedWidth =10080
                    LayoutCachedHeight =720
                    BackThemeColorIndex =-1
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =60
                    Width =780
                    Height =720
                    FontSize =8
                    ForeColor =-2147483617
                    Name ="cmdInstalls"
                    Caption ="Installs"
                    StatusBarText ="Open installs window"
                    FontName ="Arial"
                    ControlTipText ="Open installs window"
                    GridlineColor =10921638
                    ImageData = Begin
                        0x2800000010000000100000000100200000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000000000000000000000696969ff696969ff696969ff696969ff696969ff ,
                        0x696969ff696969ff696969ff696969ff696969ff696969ff696969ff696969ff ,
                        0x000000000000000000000000696969ffffffffffffffffffffffffffb3b3b3ff ,
                        0xffffffffffffffffffffffffb3b3b3ffffffffffffffffffffffffff696969ff ,
                        0x000000000000000000000000696969ffffffffffffffffffffffffffb3b3b3ff ,
                        0xffffffffffffffffffffffffb3b3b3ffffffffffffffffffffffffff696969ff ,
                        0x000000000000000000000000696969ffb3b3b3ffb3b3b3ffb3b3b3ffb3b3b3ff ,
                        0xb3b3b3ffb3b3b3ffb3b3b3ffb3b3b3ffb3b3b3ffb3b3b3ffb3b3b3ff696969ff ,
                        0x000000000000000000000000696969ffffffffffffffffffffffffffb3b3b3ff ,
                        0xffffffffffffffffffffffffb3b3b3ffffffffffffffffffffffffff696969ff ,
                        0x000000000000000000000000696969ffffffffffffffffffffffffffb3b3b3ff ,
                        0xffffffffffffffffffffffffb3b3b3ffffffffffffffffffffffffff696969ff ,
                        0x000000000000000000000000696969ffb3b3b3ffb3b3b3ffb3b3b3ffb3b3b3ff ,
                        0xb3b3b3ffb3b3b3ffb3b3b3ffb3b3b3ffb3b3b3ffb3b3b3ffb3b3b3ff696969ff ,
                        0x000000000000000000000000696969ffffffffffffffffffffffffffb3b3b3ff ,
                        0xffffffffffffffffffffffffb3b3b3ffffffffffffffffffffffffff696969ff ,
                        0x000000000000000000000000696969ffffffffffffffffffffffffffb3b3b3ff ,
                        0xffffffffffffffffffffffffb3b3b3ffffffffffffffffffffffffff696969ff ,
                        0x000000000000000000000000696969ff696969ff696969ff696969ff696969ff ,
                        0x696969ff696969ff696969ff696969ff696969ff696969ff696969ff696969ff ,
                        0x000000000000000000000000696969ff696969ff696969ff696969ff696969ff ,
                        0x696969ff696969ff696969ff696969ff696969ff696969ff696969ff696969ff ,
                        0x000000000000000000000000696969ff696969ff696969ff696969ff696969ff ,
                        0x696969ff696969ff696969ff696969ff696969ff696969ff696969ff696969ff ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End

                    LayoutCachedLeft =60
                    LayoutCachedWidth =840
                    LayoutCachedHeight =720
                    PictureCaptionArrangement =3
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    Gradient =0
                    BackColor =-2147483618
                    BackThemeColorIndex =-1
                    BackTint =100.0
                    OldBorderStyle =0
                    BorderColor =0
                    BorderThemeColorIndex =-1
                    BorderTint =100.0
                    ThemeFontIndex =-1
                    HoverColor =-2147483619
                    HoverThemeColorIndex =-1
                    HoverTint =100.0
                    PressedColor =-2147483619
                    PressedThemeColorIndex =-1
                    PressedShade =100.0
                    HoverForeColor =-2147483617
                    HoverForeThemeColorIndex =-1
                    HoverForeTint =100.0
                    PressedForeColor =-2147483617
                    PressedForeThemeColorIndex =-1
                    PressedForeTint =100.0
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =2
                    WebImagePaddingBottom =2
                    Overlaps =1
                End
                Begin Subform
                    OverlapFlags =87
                    Top =720
                    Width =10080
                    Height =7980
                    TabIndex =1
                    Name ="subMain"
                    SourceObject ="Form.frmInstalls"
                    GridlineColor =10921638
                    HorizontalAnchor =2
                    VerticalAnchor =2

                    LayoutCachedTop =720
                    LayoutCachedWidth =10080
                    LayoutCachedHeight =8700
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                End
            End
        End
        Begin FormFooter
            Visible = NotDefault
            Height =0
            BackColor =1315470
            Name ="secFormFooter"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database

Private Sub cmdChangePassword_Click()
    DoCmd.OpenForm "fdlgChangePassword", acNormal, , , , acWindowNormal
    Forms(fdlgChangePassword).SetFocus
End Sub

Private Sub cmdLogout_Click()

    Dim strSQL As String
    Dim intLoopCount As Integer

    ' Disable warnings, as DoCmd.RunSQL asks user for confirmation before executing
    DoCmd.SetWarnings False
    
    ' On closing the form, remove this connection from open connections list
    strSQL = "Delete * From [tblConnections] WHERE [strHostname] = '" & Form_fdlgUserControl.GetHostname() & "'"
    DoCmd.RunSQL strSQL
    
    ' Re-enable warnings (in effect, return to default setting)
    DoCmd.SetWarnings True
    
    ' Close all forms except login form
    For intLoopCount = (Forms.Count - 1) To 0 Step -1
        DoCmd.Close acForm, Forms(intLoopCount).Name
        Next intLoopCount
    
    ' Close all reports
    For intLoopCount = (Reports.Count - 1) To 0 Step -1
        DoCmd.Close acReport, Reports(intLoopCount).Name
        Next intLoopCount
    
    ' Re-open login form
    DoCmd.OpenForm "fdlgLogIn", acNormal, , , , acDialog

End Sub


Private Sub Form_Close()
    
    Dim strSQL As String

    ' Disable warnings, as DoCmd.RunSQL asks user for confirmation before executing
    DoCmd.SetWarnings False
    
    ' On closing the form, sets the "currentUser" instance variable to null to effectively log user out
    strSQL = "Delete * From [zstlkpInstanceVariables] WHERE [strKey]='currentUser'"
    DoCmd.RunSQL strSQL
    
    ' Re-enable warnings (in effect, return to default setting)
    DoCmd.SetWarnings True
    
End Sub

Private Sub Form_Load()

    DoCmd.Maximize

    DoCmd.OpenForm "fsysDetectIdleTime", acNormal, , , , acHidden
    
    Dim varCurrentVerMajor As Variant
    Dim varCurrentVerMinor As Variant
    Dim varCurrentVerPatch As Variant
    Dim strCurrentUser As String
    Dim strUserLevel As String
    Dim strUserTitle As String
    
    ' Look up current app version number from instance variables and set version label
    varCurrentVerMajor = DLookup("[strValue]", "zstlkpInstanceVariables", "[strKey] = 'FrontendVersionMajor'")
    varCurrentVerMinor = DLookup("[strValue]", "zstlkpInstanceVariables", "[strKey] = 'FrontendVersionMinor'")
    varCurrentVerPatch = DLookup("[strValue]", "zstlkpInstanceVariables", "[strKey] = 'FrontendVersionPatch'")
    lblVersion.Caption = "version " & varCurrentVerMajor _
        & "." & varCurrentVerMinor & "." & varCurrentVerPatch
    
    ' Look up current user's name from instance variables and set logged-in-as label
    strCurrentUser = Form_fdlgUserControl.GetCurrentUser()
    lblLoggedInAs.Caption = "Logged in as " & Form_fdlgUserControl.GetUserDisplayName(strCurrentUser)
    
    ' Look up current user's title and set title label
    strUserTitle = Form_fdlgUserControl.GetUserTitle(strCurrentUser)
    lblTitle.Caption = strUserTitle
    
    ' Look up current user's permission level
    strUserLevel = Form_fdlgUserControl.GetUserAccountType(strCurrentUser)
    
    ' Permission-based tabs
    If strUserLevel = "Technician" Then
        
    End If
    
    If strUserLevel = "Administrator" Then
        
    End If
    
    If strUserLevel = "setup" Then
       
    End If
    
End Sub
